<html>
<head>
<title>Behaviour of Functions inside Functions</title>
<link rel="StyleSheet" href="./../../style.css" type="text/css">
</head>
<body>
<table>
<tr>
<td>
<a href="./../../" class="nav">Contents</a></td>
<td>
<a href="./" class="nav">Up</a></td>
<td>
<a href="./" class="nav">Previous</a></td>
<td>
<a href="./dispatch.html" class="nav">Next</a></td>
</tr>
</table>

<h1 class="fcs">2.3.1 Behaviour of Functions inside Functions</h1>

<p>
One can define such a reference to a function within another function. It
is possible that this reference will be made accessible to the outside world 
after the outer function has terminated. In that case, the the inner function 
(which is called a <b>closure</b>) will remember all the relevant variables
of the outer function.
</p>

<p>
Note that if two calls were made to the outer function, then the two resulting
closures are by no mean related. Thus, changes in the variables of one closure
will not affect the other. (unless, of course, they are global to both).
</p>

<p>
Here's an example to illustrate this:
</p>


<p>
<table class="mycode">
<tr class="mycode">
<td class="mycode">
    <pre class="mycode">

<font color="#a020f0">#!/usr/bin/perl</font>

<font color="#a52a2a"><b>sub</b></font><font color="#008b8b"> </font><font color="#008b8b">create_counter</font>
{
    <font color="#a52a2a"><b>my</b></font> <font color="#008b8b">$counter</font> = <font color="#ff00ff">0</font>;

    <font color="#a52a2a"><b>my</b></font> <font color="#008b8b">$counter_func</font> =<font color="#008b8b"> </font><font color="#a52a2a"><b>sub</b></font><font color="#008b8b"> </font>{
        <font color="#a52a2a"><b>return</b></font> (<font color="#008b8b">$counter</font>++);
    };

    <font color="#a52a2a"><b>return</b></font> <font color="#008b8b">$counter_func</font>;
}

<font color="#a52a2a"><b>my</b></font> <font color="#008b8b">@counters</font> = (<font color="#008b8b">&amp;create_counter</font>(), <font color="#008b8b">&amp;create_counter</font>());

<font color="#0000ff"># Initialize the random number generator to a constant value;</font>
<font color="#a52a2a"><b>srand</b></font>(<font color="#ff00ff">24</font>);

<font color="#a52a2a"><b>for</b></font>(<font color="#a52a2a"><b>my</b></font> <font color="#008b8b">$a</font>=<font color="#ff00ff">0</font>; <font color="#008b8b">$a</font> &lt; <font color="#ff00ff">100</font> ; <font color="#008b8b">$a</font>++)
{
    <font color="#0000ff"># This call generates a random number that is either 0 or 1</font>
    <font color="#a52a2a"><b>my</b></font> <font color="#008b8b">$which_counter</font> = <font color="#a52a2a"><b>int</b></font>(<font color="#a52a2a"><b>rand</b></font>(<font color="#ff00ff">2</font>));

    <font color="#a52a2a"><b>my</b></font> <font color="#008b8b">$value</font> = <font color="#008b8b">$counters</font>[<font color="#008b8b">$which_counter</font>]-&gt;();

    <font color="#a52a2a"><b>print</b></font> <font color="#ff00ff">&quot;</font><font color="#008b8b">$which_counter</font><font color="#ff00ff"> = </font><font color="#008b8b">$value</font><font color="#6a5acd">\n</font><font color="#ff00ff">&quot;</font>;
}

</pre>
</td>
</tr>
</table>
</p>



<hr>
<table>
<tr>
<td>
<a href="./../../" class="nav">Contents</a></td>
<td>
<a href="./" class="nav">Up</a></td>
<td>
<a href="./" class="nav">Previous</a></td>
<td>
<a href="./dispatch.html" class="nav">Next</a></td>
</tr>
</table>

</body>
</html>


